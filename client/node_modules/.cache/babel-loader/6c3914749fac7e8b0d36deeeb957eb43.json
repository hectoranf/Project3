{"ast":null,"code":"import _objectSpread from\"/home/hector/Escritorio/ironkack/project3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/hector/Escritorio/ironkack/project3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/hector/Escritorio/ironkack/project3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/hector/Escritorio/ironkack/project3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/hector/Escritorio/ironkack/project3/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import MediaService from'./../../../../service/media.service';import MeetingService from'./../../../../service/meeting.service';import'./CreateMeetingForm.css';import Container from'react-bootstrap/Container';import Row from'react-bootstrap/Row';import Col from'react-bootstrap/Col';import Form from'react-bootstrap/Form';import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";var CreateMeetingForm=/*#__PURE__*/function(_Component){_inherits(CreateMeetingForm,_Component);var _super=_createSuper(CreateMeetingForm);function CreateMeetingForm(props){var _this;_classCallCheck(this,CreateMeetingForm);_this=_super.call(this,props);_this.createMeeting=function(){_this.meetingService.createMeeting(_this.state.meeting).then(function(response){_this.props.setTheUser(response.data);_this.props.history.push('/');}).catch(function(err){return console.log(err);});};_this.handleInputChange=function(e){var meetingCopy=_objectSpread({},_this.state.meeting);meetingCopy[e.target.name]=e.target.value;_this.setState({meeting:meetingCopy});};_this.handleResultsVisibility=function(visibility){return _this.setState(_objectSpread(_objectSpread({},_this.state),{},{resultVisibility:visibility}));};_this.handleMouseOver=function(status){return _this.setState(_objectSpread(_objectSpread({},_this.state),{},{mouseIsOver:status}));};_this.setMedia=function(media){var mediaAux={title:'',type:media.media_type,idTMDB:media.id,posterPic:media.poster_path};mediaAux.type==='tv'?mediaAux.title=media.name:mediaAux.title=media.title;var meetingCopy=_objectSpread(_objectSpread({},_this.state.meeting),{},{media:mediaAux});document.getElementById('media-title').value=mediaAux.title;_this.setState({meeting:meetingCopy,resultVisibility:'none'});};_this.handleSearch=function(e){var value=e.target.value;if(value.length>0){_this.handleResultsVisibility('block');_this.mediaService.getAll(value).then(function(response){_this.setState(_objectSpread(_objectSpread({},_this.state),{},{searchInput:value,results:response.data.results.filter(function(elm){return elm.media_type==='tv'||elm.media_type==='movie';})}));}).catch(function(err){return console.log(err);});}else{_this.handleResultsVisibility('none');_this.setState(_objectSpread(_objectSpread({},_this.state),{},{searchInput:value,results:[]}));}};_this.handleDate=function(date){var meetingCopy=_objectSpread({},_this.state.meeting);meetingCopy.date=date;_this.setState({meeting:meetingCopy});};_this.handleLocation=function(e){var locationAux=_this.props.user.places[e.target.value].location;var meetingCopy=_objectSpread(_objectSpread({},_this.state.meeting),{},{location:locationAux});_this.setState({meeting:meetingCopy});};_this.handleSubmit=function(e){e.preventDefault();var meetingCopy=_objectSpread(_objectSpread({},_this.state.meeting),{},{creator:_this.props.user._id,seats:_this.state.meeting.freeSeats});if(meetingCopy.location.coordinates.length!==2)meetingCopy.location.coordinates=_this.props.user.places[0].location.coordinates;if(!meetingCopy.media.title)meetingCopy.media.title=_this.state.searchInput;_this.setState({meeting:meetingCopy},function(){return _this.createMeeting();});};_this.state={meeting:{meetingName:'',media:{title:'',type:'tv',idTMDB:1,posterPic:''},date:new Date(),description:'',seats:'',freeSeats:1,creator:'',location:{type:'Point',coordinates:[]},snackList:[]},results:[],resultVisibility:'none',mouseIsOver:'false',searchInput:''};_this.mediaService=new MediaService();_this.meetingService=new MeetingService();return _this;}_createClass(CreateMeetingForm,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(Container,{className:\"creating-meeting\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:{span:8,offset:2}},/*#__PURE__*/React.createElement(\"h1\",null,\"Datos de la quedada\"),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(Form,{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(Form.Group,{controlId:\"media-title\",onBlur:function onBlur(){return!_this2.state.mouseIsOver&&_this2.handleResultsVisibility('none');},onFocus:function onFocus(){return _this2.handleResultsVisibility('block');}},/*#__PURE__*/React.createElement(Form.Label,null,\"\\xBFQu\\xE9 vais a ver?\"),/*#__PURE__*/React.createElement(Form.Control,{name:\"media-title\",type:\"text\",placeholder:\"Titulo...\",onChange:this.handleSearch,autoComplete:\"off\",required:true}),/*#__PURE__*/React.createElement(\"ul\",{onMouseOver:function onMouseOver(){return _this2.handleMouseOver(true);},onMouseOut:function onMouseOut(){return _this2.handleMouseOver(false);},className:\"search-results\",style:{display:this.state.resultVisibility}},this.state.results.map(function(elm,idx){return/*#__PURE__*/React.createElement(\"li\",{key:idx,onClick:function onClick(){return _this2.setMedia(elm);}},elm.poster_path&&/*#__PURE__*/React.createElement(\"img\",{className:\"miniature\",src:\"http://image.tmdb.org/t/p/w92\".concat(elm.poster_path),alt:\"poster\"}),/*#__PURE__*/React.createElement(\"p\",null,elm.media_type==='tv'?elm.name:elm.title));}))),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"meetingName\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Pon nombre a tu quedada\"),/*#__PURE__*/React.createElement(Form.Control,{placeholder:\"Ej: marat\\xF3n de F\\xB7R\\xB7I\\xB7E\\xB7N\\xB7D\\xB7S\",name:\"meetingName\",type:\"textField\",onChange:this.handleInputChange,value:this.state.meeting.meetingName,autoComplete:\"off\"})),/*#__PURE__*/React.createElement(Form.Row,null,/*#__PURE__*/React.createElement(Form.Group,{as:Col,controlId:\"freeSeats\",md:\"6\"},/*#__PURE__*/React.createElement(Form.Label,null,\"\\xBFCuantos invitados quieres que asistan?\"),/*#__PURE__*/React.createElement(Form.Control,{name:\"freeSeats\",type:\"number\",onChange:this.handleInputChange,value:this.state.meeting.freeSeats,autoComplete:\"off\"})),/*#__PURE__*/React.createElement(Form.Group,{as:Col,controlId:\"date\",md:\"6\"},/*#__PURE__*/React.createElement(Form.Label,null,\"\\xBFCu\\xE1ndo va a ser?\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(DatePicker,{className:\"form-date\",showTimeSelect:true,selected:this.state.meeting.date,onChange:function onChange(date){return _this2.handleDate(date);},timeFormat:\"HH:mm\",timeIntervals:15,timeCaption:\"time\",dateFormat:\"yyyy/MM/dd hh:mm aa\"}))),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"desc\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Descripci\\xF3n\"),/*#__PURE__*/React.createElement(Form.Control,{as:\"textarea\",placeholder:\"Da a tus invitados una idea de c\\xF3mo va a ser la quedada\",name:\"description\",type:\"text\",onChange:this.handleInputChange,value:this.state.meeting.description,autoComplete:\"off\"})),/*#__PURE__*/React.createElement(Form.Group,{controlId:\"location\"},/*#__PURE__*/React.createElement(Form.Label,null,\"\\xBFD\\xF3nde va a ser la quedada?\"),/*#__PURE__*/React.createElement(Form.Control,{as:\"select\",onChange:this.handleLocation,custom:true},/*#__PURE__*/React.createElement(\"option\",{value:\"0\"},\"...\"),this.props.user&&this.props.user.places.map(function(elm,idx){return/*#__PURE__*/React.createElement(\"option\",{key:elm._id,value:idx},elm.name);}))),/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"button\",{className:\"form-button\",type:\"submit\"},\"Crea tu quedada\")))));}}]);return CreateMeetingForm;}(Component);export default CreateMeetingForm;","map":{"version":3,"sources":["/home/hector/Escritorio/ironkack/project3/client/src/components/pages/meeting/create/CreateMeetingForm.js"],"names":["React","Component","MediaService","MeetingService","Container","Row","Col","Form","DatePicker","CreateMeetingForm","props","createMeeting","meetingService","state","meeting","then","response","setTheUser","data","history","push","catch","err","console","log","handleInputChange","e","meetingCopy","target","name","value","setState","handleResultsVisibility","visibility","resultVisibility","handleMouseOver","status","mouseIsOver","setMedia","media","mediaAux","title","type","media_type","idTMDB","id","posterPic","poster_path","document","getElementById","handleSearch","length","mediaService","getAll","searchInput","results","filter","elm","handleDate","date","handleLocation","locationAux","user","places","location","handleSubmit","preventDefault","creator","_id","seats","freeSeats","coordinates","meetingName","Date","description","snackList","span","offset","display","map","idx"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nimport MediaService from './../../../../service/media.service'\nimport MeetingService from './../../../../service/meeting.service'\n\nimport './CreateMeetingForm.css'\n\nimport Container from 'react-bootstrap/Container'\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Form from 'react-bootstrap/Form'\nimport DatePicker from \"react-datepicker\";\nimport \"react-datepicker/dist/react-datepicker.css\";\nclass CreateMeetingForm extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            meeting: {\n                meetingName: '',\n                media: {\n                    title: '',\n                    type: 'tv',\n                    idTMDB: 1,\n                    posterPic: ''\n                },\n                date: new Date(),\n                description: '',\n                seats: '',\n                freeSeats: 1,\n                creator: '',\n                location: {\n                    type: 'Point',\n                    coordinates: []\n                },\n                snackList: []\n            },\n            results: [],\n            resultVisibility: 'none',\n            mouseIsOver: 'false',\n            searchInput: ''\n        }\n        this.mediaService = new MediaService()\n        this.meetingService = new MeetingService()\n    }\n\n    createMeeting = () => {\n        this.meetingService.createMeeting(this.state.meeting)\n            .then(response => {\n                this.props.setTheUser(response.data)\n                this.props.history.push('/')\n            })\n            .catch(err => console.log(err))\n    }\n\n    handleInputChange = e => {\n        let meetingCopy = { ...this.state.meeting }\n        meetingCopy[e.target.name] = e.target.value\n        this.setState({\n            meeting: meetingCopy\n        })\n    }\n\n    handleResultsVisibility = visibility => this.setState({ ...this.state, resultVisibility: visibility })\n\n    handleMouseOver = status => this.setState({ ...this.state, mouseIsOver: status })\n\n    setMedia = (media) => {\n\n        let mediaAux = {\n            title: '',\n            type: media.media_type,\n            idTMDB: media.id,\n            posterPic: media.poster_path\n        }\n        mediaAux.type === 'tv' ? mediaAux.title = media.name : mediaAux.title = media.title\n\n        let meetingCopy = { ...this.state.meeting, media: mediaAux }\n        document.getElementById('media-title').value = mediaAux.title\n        this.setState({ meeting: meetingCopy, resultVisibility: 'none' })\n    }\n\n    handleSearch = e => {\n        const value = e.target.value\n        if (value.length > 0) {\n            this.handleResultsVisibility('block')\n            this.mediaService.getAll(value)\n                .then(response => {\n                    this.setState({ ...this.state, searchInput: value, results: response.data.results.filter(elm => (elm.media_type === 'tv' || elm.media_type === 'movie')) })\n                })\n                .catch(err => console.log(err))\n        } else {\n            this.handleResultsVisibility('none')\n            this.setState({ ...this.state, searchInput: value, results: [] })\n        }\n    }\n\n    handleDate = date => {\n        let meetingCopy = { ...this.state.meeting }\n        meetingCopy.date = date\n        this.setState({ meeting: meetingCopy })\n    }\n\n    handleLocation = e => {\n        const locationAux = this.props.user.places[e.target.value].location\n        let meetingCopy = { ...this.state.meeting, location: locationAux }\n        this.setState({ meeting: meetingCopy })\n    }\n\n    handleSubmit = e => {\n        e.preventDefault()\n        let meetingCopy = { ...this.state.meeting, creator: this.props.user._id, seats: this.state.meeting.freeSeats }\n        if (meetingCopy.location.coordinates.length !== 2) meetingCopy.location.coordinates = this.props.user.places[0].location.coordinates\n        if (!meetingCopy.media.title) meetingCopy.media.title = this.state.searchInput\n        this.setState({ meeting: meetingCopy }, () => this.createMeeting())\n    }\n\n    render() {\n        return (\n\n            <Container className='creating-meeting'>\n                <Row>\n                    <Col md={{ span: 8, offset: 2 }}>\n                        <h1>Datos de la quedada</h1>\n                        <hr />\n                        <Form onSubmit={this.handleSubmit}>\n\n                            <Form.Group controlId=\"media-title\"\n                                onBlur={() => !this.state.mouseIsOver && this.handleResultsVisibility('none')}\n                                onFocus={() => this.handleResultsVisibility('block')}>\n                                <Form.Label>¿Qué vais a ver?</Form.Label>\n                                <Form.Control name=\"media-title\"\n                                    type=\"text\"\n                                    placeholder='Titulo...'\n                                    onChange={this.handleSearch}\n                                    autoComplete=\"off\"\n                                    required />\n\n                                <ul onMouseOver={() => this.handleMouseOver(true)} onMouseOut={() => this.handleMouseOver(false)} className='search-results' style={{ display: this.state.resultVisibility }}>\n                                    {this.state.results.map((elm, idx) => <li key={idx} onClick={() => this.setMedia(elm)}>\n                                        {elm.poster_path && <img className='miniature' src={`http://image.tmdb.org/t/p/w92${elm.poster_path}`} alt='poster' />}\n                                        <p>{elm.media_type === 'tv' ? elm.name : elm.title}</p>\n                                    </li>)}\n                                </ul>\n                            </Form.Group>\n\n                            <Form.Group controlId=\"meetingName\">\n                                <Form.Label>Pon nombre a tu quedada</Form.Label>\n                                <Form.Control\n                                    placeholder='Ej: maratón de F·R·I·E·N·D·S'\n                                    name=\"meetingName\"\n                                    type=\"textField\"\n                                    onChange={this.handleInputChange}\n                                    value={this.state.meeting.meetingName}\n                                    autoComplete=\"off\" />\n                            </Form.Group>\n\n                            <Form.Row>\n                                <Form.Group as={Col} controlId=\"freeSeats\" md=\"6\">\n                                    <Form.Label>¿Cuantos invitados quieres que asistan?</Form.Label>\n                                    <Form.Control\n                                        name=\"freeSeats\"\n                                        type=\"number\"\n                                        onChange={this.handleInputChange}\n                                        value={this.state.meeting.freeSeats}\n                                        autoComplete=\"off\" />\n                                </Form.Group>\n\n                                <Form.Group as={Col} controlId=\"date\" md='6'>\n                                    <Form.Label>¿Cuándo va a ser?</Form.Label>\n                                    <br />\n                                    <DatePicker\n                                        className='form-date'\n                                        showTimeSelect\n                                        selected={this.state.meeting.date}\n                                        onChange={date => this.handleDate(date)}\n                                        timeFormat=\"HH:mm\"\n                                        timeIntervals={15}\n                                        timeCaption=\"time\"\n                                        dateFormat=\"yyyy/MM/dd hh:mm aa\"\n                                    />\n                                </Form.Group>\n                            </Form.Row>\n\n                            <Form.Group controlId=\"desc\">\n                                <Form.Label>Descripción</Form.Label>\n                                <Form.Control as='textarea'\n                                    placeholder='Da a tus invitados una idea de cómo va a ser la quedada'\n                                    name=\"description\"\n                                    type=\"text\"\n                                    onChange={this.handleInputChange}\n                                    value={this.state.meeting.description}\n                                    autoComplete=\"off\" />\n                            </Form.Group>\n\n                            <Form.Group controlId=\"location\">\n                                <Form.Label>¿Dónde va a ser la quedada?</Form.Label>\n                                <Form.Control as=\"select\" onChange={this.handleLocation} custom>\n                                    <option value='0'>...</option>\n                                    {this.props.user && this.props.user.places.map((elm, idx) => <option key={elm._id} value={idx}>{elm.name}</option>)}\n                                </Form.Control>\n                            </Form.Group>\n\n                            <hr />\n                            <button className=\"form-button\" type=\"submit\">Crea tu quedada</button>\n                        </Form>\n                    </Col>\n                </Row>\n\n            </Container >\n\n        )\n    }\n\n}\n\nexport default CreateMeetingForm"]},"metadata":{},"sourceType":"module"}